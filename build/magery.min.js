var Magery=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:false};e[n].call(i.exports,i,i.exports,r);i.loaded=true;return i.exports}r.m=e;r.c=t;r.p="";return r(0)}([function(e,t,r){e.exports={compile:r(1),Template:r(4),lookup:r(2).lookup,Patcher:r(5).Patcher,patch:r(5).patch}},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);var html=__webpack_require__(3);var HTML_TAGS=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BASEFONT","BDI","BDO","BGSOUND","BIG","BLINK","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","COMMAND","CONTENT","DATA","DATALIST","DD","DEL","DETAILS","DFN","DIALOG","DIR","DIV","DL","DT","ELEMENT","EM","EMBED","FIELDSET","FIGCAPTION","FIGURE","FONT","FOOTER","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","HTML","I","IFRAME","IMAGE","IMG","INPUT","INS","ISINDEX","KBD","KEYGEN","LABEL","LEGEND","LI","LINK","LISTING","MAIN","MAP","MARK","MARQUEE","MENU","MENUITEM","META","METER","MULTICOL","NAV","NOBR","NOEMBED","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","OUTPUT","P","PARAM","PICTURE","PLAINTEXT","PRE","PROGRESS","Q","RP","RT","RTC","RUBY","S","SAMP","SCRIPT","SECTION","SELECT","SHADOW","SLOT","SMALL","SOURCE","SPACER","SPAN","STRIKE","STRONG","STYLE","SUB","SUMMARY","SUP","TABLE","TBODY","TD","TEMPLATE","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","TT","U","UL","VAR","VIDEO","WBR","XMP"];var IGNORED_ATTRS=["data-each","data-if","data-unless","data-key"];function compileLookup(e){return"p.lookup(data, "+JSON.stringify(e)+")"}function compileTemplateContext(e){var t=[];utils.eachAttribute(e,function(e,r){if(IGNORED_ATTRS.indexOf(e)===-1){t.push(JSON.stringify(e)+": "+compileExpandVariables(r))}});return"{"+t.join(", ")+"}"}function compileElement(e,t,r,n){if(e.tagName==="TEMPLATE-CHILDREN"){r("inner();\n");return}if(!n&&e.dataset.template){t.push(e);r("p.render(templates, "+JSON.stringify(e.dataset.template)+", data);\n");return}if(e.dataset.each){var i=e.dataset.each.split(/\s+in\s+/);var a=i[0];var o=utils.propertyPath(i[1]);r("p.each("+"data, "+JSON.stringify(a)+", "+compileLookup(o)+", "+"function (data) {\n")}if(e.dataset.if){var s=utils.propertyPath(e.dataset.if);r("if (p.isTruthy("+compileLookup(s)+")) {\n")}if(e.dataset.unless){var u=utils.propertyPath(e.dataset.unless);r("if (!p.isTruthy("+compileLookup(u)+")) {\n")}var l=true;if(HTML_TAGS.indexOf(e.tagName)===-1){r("p.render("+"templates"+", "+JSON.stringify(e.tagName.toLowerCase())+", "+compileTemplateContext(e)+", "+(e.dataset.key?compileExpandVariables(e.dataset.key):"null")+(e.childNodes.length?", function () {":");")+"\n");l=false}else{if(n){if(e.dataset.key){r("p.enterTag("+JSON.stringify(e.tagName)+", "+"root_key || "+compileExpandVariables(e.dataset.key)+");\n")}else{r("p.enterTag("+JSON.stringify(e.tagName)+", root_key || null);\n")}}else if(e.dataset.key){r("p.enterTag("+JSON.stringify(e.tagName)+", "+compileExpandVariables(e.dataset.key)+");\n")}else{r("p.enterTag("+JSON.stringify(e.tagName)+", null);\n")}utils.eachAttribute(e,function(e,t){if(e==="data-template"){e="data-bind"}if(IGNORED_ATTRS.indexOf(e)!==-1){return}var n=e.match(/^on(.*)/);if(n){var i=n[1];var a=t.indexOf("(");var o=t.lastIndexOf(")");var s=t.substring(0,a);var u=t.substring(a+1,o).split(",");var l=[];for(var p=0,f=u.length;p<f;p++){var c=utils.trim(u[p]);if(!c){continue}if(c==="event"){l.push("p.EVENT")}else{l.push(compileLookup(utils.propertyPath(c)))}}r("p.eventListener("+JSON.stringify(n[1])+", "+JSON.stringify(s)+", "+"["+l.join(", ")+"], "+"template);\n")}else if(html.attributes[e]&html.BOOLEAN_ATTRIBUTE){if(t===""){r("p.attribute("+JSON.stringify(e)+", true);\n")}else{r("if (p.isTruthy("+compileExpandVariables(t)+")) {\n");r("p.attribute("+JSON.stringify(e)+", true);\n");r("}\n")}}else{r("p.attribute("+JSON.stringify(e)+", "+compileExpandVariables(t)+");\n")}})}utils.eachNode(e.childNodes,function(e){compileNode(e,t,r,false)});if(l){r("p.exitTag();\n")}else if(e.childNodes.length){r("});\n")}if(e.dataset.unless){r("}\n")}if(e.dataset.if){r("}\n")}if(e.dataset.each){r("});\n")}}function compileExpandVariables(e,t){var r=e.split(/{{\s*|\s*}}/);var n=r.length;var i=-1;while(++i<n){if(i%2){var a=utils.propertyPath(r[i]);r[i]=a}}if(n==1&&!r[0]&&t){return"true"}var o=[];var s=-1;while(++s<n){if(r[s].length){o.push(s%2?compileLookup(r[s]):JSON.stringify(r[s]))}}if(!o.length){return JSON.stringify("")}return o.join(" + ")}function compileText(e,t){var r=compileExpandVariables(e.textContent);if(r[0]==='"'){t("p.text("+r+");\n")}else{t('p.text("" + '+r+");\n")}}function compileDocumentFragment(e,t,r){utils.eachNode(e.childNodes,function(e){compileNode(e,t,r,false)})}function compileNode(e,t,r,n){switch(e.nodeType){case 1:compileElement(e,t,r,n);break;case 3:compileText(e,r);break;case 11:compileDocumentFragment(e,t,r);break}}function ignore_output(e){}exports.compile=function(e,t){var r=[];compileNode(e,r,ignore_output,true);t("({\n");while(r.length){e=r.shift();t(JSON.stringify(e.dataset.template)+": ");t("new Magery.Template(function (template, templates, p, data, root_key, inner) {\n");compileNode(e,r,t,true);t("})"+(r.length?",":"")+"\n")}t("})\n")};exports.compileToString=function(e){var t="";exports.compile(e,function(e){t+=e});return t};exports.eval=function(node){return eval(exports.compileToString(node))}},function(e,t){var r=1;var n=3;var i=11;t.isDocumentFragment=function(e){return e.nodeType===i};t.isElementNode=function(e){return e.nodeType===r};t.isTextNode=function(e){return e.nodeType===n};t.eachNode=function(e,t){var r=0;var n=e[0];while(n){var i=n;n=n.nextSibling;t(i,r++,e)}};t.mapNodes=function(e,r){var n=[];t.eachNode(e,function(t,i){n[i]=r(t,i,e)});return n};t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")};t.propertyPath=function(e){return e.split(".").filter(function(e){return e})};t.lookup=function(e,t){var r=e;for(var n=0,i=t.length;n<i;n++){if(r===undefined||r===null){return""}r=r[t[n]]}return r===undefined||r===null?"":r};t.templateTagName=function(e){var t=/^TEMPLATE-([^\s/>]+)/.exec(e.tagName);return t&&t[1].toLowerCase()};t.shallowClone=function(e){var t={};for(var r in e){t[r]=e[r]}return t};t.eachAttribute=function(e,t){var r=e.attributes;for(var n=0,i=e.attributes.length;n<i;n++){t(e.attributes[n].name,e.attributes[n].value)}}},function(e,t){var r=t.BOOLEAN_ATTRIBUTE=1;var n=t.USE_PROPERTY=2;var i=t.USE_PROPERTY=4;t.attributes={allowfullscreen:r,async:r,autofocus:r,autoplay:r,capture:r,checked:r|n,controls:r,default:r,defer:r,disabled:r,formnovalidate:r,hidden:r,itemscope:r,loop:r,multiple:r|n,muted:r|n,novalidate:r,open:r,readonly:r,required:r,reversed:r,selected:r|n,value:n|i}},function(e,t){function r(e){this._render=e;this.handlers={}}r.prototype.bind=function(e){this.handlers=e};e.exports=r},function(e,t,r){var n=r(6);var i=r(2);var a=r(3);var o=r(7);var s=1;var u=3;function l(e,t,r){return(e.tagName===t||e.nodeType===u&&t==="#text")&&e.key==r}function p(e,t,r,n){if(t&&l(t,r,n)){return t}if(n&&e.keymap){return e.keymap[n]||null}return null}function f(e,t,r){while(r){var n=r;r=r.nextSibling;e.removeChild(t,n)}}function c(e,t){var r=t.attributes;var n=[];var i,a;for(i=0,a=r.length;i<a;i++){var o=r[i];if(!t.visited_attributes.has(o.name)){n.push(o.name)}}for(i=0,a=n.length;i<a;i++){e.removeAttribute(t,n[i]);if(n[i]==="value"){e.removeEventListener(t,"input",g)}}}function h(e,t){if(!t.handlers){return}for(var r in t.handlers){if(!t.visited_events.has(r)){e.removeEventListener(t,r,t.handlers[r]);delete t.handlers[r]}}}function d(e,t){this.transforms=t||n;this.root=e;this.reset()}t.Patcher=d;d.prototype.reset=function(){this.parent=this.root.parentNode;this.current=this.root};d.prototype.stepInto=function(e){if(e.visited_attributes){e.visited_attributes.clear()}else{e.visited_attributes=new o}if(e.visited_events){e.visited_events.clear()}else{e.visited_events=new o}this.parent=e;this.current=e.firstChild};d.prototype.enterTag=function(e,t){var r=p(this.parent,this.current,e,t);if(!r){r=this.transforms.insertElement(this.parent,this.current,e);if(t){if(!this.parent.keymap){this.parent.keymap={}}this.parent.keymap[t]=r;r.key=t}}else if(!this.current){this.transforms.appendChild(this.parent,r)}else if(r!==this.current){this.transforms.replaceChild(this.parent,r,this.current)}if(!this.template_root){this.template_root=r}this.stepInto(r)};d.prototype.EVENT={};function v(e){return function(t){var r=t.target;var n=r.handlers[e];if(n.name){var i=n.args.map(function(e){if(e===d.prototype.EVENT){return t}return e});r.template.handlers[n.name].apply(n.template_root,i)}if(r.tagName==="INPUT"){var a=r.getAttribute("type");if(e=="change"){if(a==="checkbox"){T(t)}else if(a==="radio"){E(t)}}else if(e=="input"&&r.hasAttribute("value")){g(t)}}else if(r.tagName==="SELECT"){N(t)}}}function m(e,t){if(!e.handlers){e.handlers={}}if(!e.handlers.hasOwnProperty(t)){var r=v(t);e.handlers[t]={fn:r};e.addEventListener(t,r)}e.visited_events.add(t)}d.prototype.eventListener=function(e,t,r,n){var i=this.parent;if(i.template!==n){i.template=n}m(i,e);var a=i.handlers[e];a.name=t;a.args=r;a.template_root=this.template_root};function T(e){var t=e.target;if(t.dataset["managed"]==="true"){t.checked=t.hasAttribute("checked")}}function E(e){var t=e.target;if(t.dataset["managed"]==="true"){var r=t.hasAttribute("checked");if(t.checked!=r){if(t.name){var n=document.getElementsByName(t.name);for(var i=0,a=n.length;i<a;i++){var o=n[i];o.checked=o.hasAttribute("checked")}}else{t.checked=r}}}}function N(e){var t=e.target;if(t.dataset["managed"]==="true"){var r=t.getElementsByTagName("option");for(var n=0,i=r.length;n<i;n++){var a=r[n];a.selected=a.hasAttribute("selected")}}}function g(e){var t=e.target;if(t.dataset["managed"]==="true"){var r=t.getAttribute("value");if(t.value!==r){t.value=r}}}d.prototype.attribute=function(e,t){var r=this.parent;if(r.getAttribute(e)!==t){this.transforms.setAttribute(r,e,t)}r.visited_attributes.add(e)};d.prototype.text=function(e){var t=p(this.parent,this.current,"#text",null);if(!t){t=this.transforms.insertTextNode(this.parent,this.current,e)}else if(t.textContent!==e){this.transforms.replaceText(t,e)}this.current=t.nextSibling};function A(e,t){return e.handlers&&e.handlers[t]&&e.handlers[t].fn}d.prototype.exitTag=function(){f(this.transforms,this.parent,this.current);var e=this.parent;this.parent=e.parentNode;this.current=e.nextSibling;if(e.tagName==="INPUT"){var t=e.getAttribute("type");if(t==="checkbox"||t=="radio"){m(e,"change")}else if(e.hasAttribute("value")){m(e,"input")}}else if(e.tagName==="SELECT"){m(e,"change")}c(this.transforms,e);h(this.transforms,e)};d.prototype.skip=function(e,t){var r=p(this.parent,this.current,e,t);if(!this.current){this.transforms.appendChild(this.parent,r)}else if(r!==this.current){this.transforms.replaceChild(this.parent,r,this.current)}this.current=r.nextSibling};d.prototype.lookup=i.lookup;d.prototype.isTruthy=function(e){if(Array.isArray(e)){return e.length>0}return e};d.prototype.each=function(e,t,r,n){for(var a=0,o=r.length;a<o;a++){var s=i.shallowClone(e);s[t]=r[a];n(s)}};d.prototype.render=function(e,t,r,n,i){var a=e[t];var o=this.template_root;this.template_root=null;a._render(a,e,this,r,n,i);this.template_root=o};t.patch=function(e,t,r,n){new d(n).render(e,t,r)}},function(e,t,r){var n=r(3);t.insertTextNode=function(e,t,r){var n=document.createTextNode(r);e.insertBefore(n,t);return n};t.replaceText=function(e,t){e.textContent=t;return e};t.replaceChild=function(e,t,r){e.replaceChild(t,r);return t};t.appendChild=function(e,t){e.appendChild(t);return t};t.insertElement=function(e,t,r){var n=document.createElement(r);e.insertBefore(n,t);return n};t.removeChild=function(e,t){e.removeChild(t);return t};t.setAttribute=function(e,t,r){if(n.attributes[t]&n.USE_PROPERTY){e[t]=r}e.setAttribute(t,r);return e};t.removeAttribute=function(e,t){console.log("removeAttribute: "+t);if(n.attributes[t]&n.USE_PROPERTY){e[t]=false}e.removeAttribute(t);return e};t.addEventListener=function(e,t,r){e.addEventListener(t,r,false);return e};t.removeEventListener=function(e,t,r){e.removeEventListener(t,r);return e}},function(e,t){if(typeof Set==="undefined"){function r(){this.values=[]}r.prototype.add=function(e){this.values.push(e)};r.prototype.has=function(e){return this.values.indexOf(e)!==-1};r.prototype.clear=function(){this.values=[]};e.exports=r}else{e.exports=Set}}]);